app.controller("BoardController",["$scope","$rootScope","$http","$timeout","$routeParams",function(e,t,o,s,r){for(t.title="Board",t.navTopTransparentClass=!1,e.navBoard=!0,e.grid=[],e.rows=sessionStorage.getItem("gridRows")?parseInt(sessionStorage.getItem("gridRows")):3,e.columns=sessionStorage.getItem("gridColumns")?parseInt(sessionStorage.getItem("gridColumns")):3,i=0;i<e.rows;i++){var n=[];for(c=0;c<e.columns;c++)n.push(c);e.grid.push(n)}e.addRow=function(){if(e.rows>5)return!1;e.rows=e.rows+1,sessionStorage.setItem("gridRows",e.rows);var t=[];for(c=0;c<e.columns;c++)t.push(c);e.grid.push(t)},e.removeRow=function(){if(e.rows<3)return!1;e.rows=e.rows-1,sessionStorage.setItem("gridRows",e.rows);var t=[];for(c=0;c<e.columns;c++)t.push(c);e.grid.pop()},e.addColumn=function(){if(e.columns>5)return!1;for(i=0;i<e.rows;i++)e.grid[i].push(e.columns);e.columns=e.columns+1,sessionStorage.setItem("gridColumns",e.columns)},e.removeColumn=function(){if(e.columns<3)return!1;for(i=0;i<e.rows;i++)e.grid[i].pop();e.columns=e.columns-1,sessionStorage.setItem("gridColumns",e.columns)};var a=r.id;o.get(appConfig.apiUrl+"/id/"+a).success(function(t){e.grid[1][1]=t;var o=function(){e.fadeInUmi=!0};s(o,250)}).error(function(e,t){alert("No data to display :-("),console.log(e+" | "+t)}),e.position=function(t,s,i,r){var n=[];if("up"==i)var a=[t-1,s];else if("down"==i)var a=[t+1,s];else if("left"==i)var a=[t,s-1];else if("right"==i)var a=[t,s+1];0==a[0]?n.push("closes-top"):2==a[0]?n.push("closes-bottom"):0==a[1]?n.push("closes-left"):2==a[1]&&n.push("closes-right"),o.get(appConfig.apiUrl+"/id/"+r).success(function(t){t.closingClasses=n.join(" "),e.grid[a[0]][a[1]]=t}).error(function(e,t){alert("No data to display :-("),console.log(e+" | "+t)})}}]),app.controller("ContributeController",["$scope","$rootScope","$http","$location",function(e,t,o,s){e.omUser||(alert("You must be logged in to Contribute to OpenMaths!"),s.path("/")),t.title="Contribute",t.navTopTransparentClass=!1,e.navContribute=!0,e.errorMessages={required:"This field is required.",maxLength:"This field is exceeding the maximum length of 128 characters.",umiTitle:"The title should only consist of letters, spaces, or hyphens"},e.instructions={type:"What category of information?",title:"Users will be able to search your contribution.",titleSynonyms:"Comma-separated list of alternative names.",latexContent:"The actual content. You are free to use LaTeX (including text-mode macros!!).",prerequisiteDefinitions:"Comma-separated list of valid Titles upon which your contribution depends.",seeAlso:"Comma-separated list of valid Titles which may be related.",tags:"Comma-separated list of tags to help users find your contribution.",dispatch:"Submitting your contribution will create a request to pull the content into our database."},e.umiTypes=[{id:"Definition",label:"Definition"},{id:"Axiom",label:"Axiom"},{id:"Theorem",label:"Theorem"},{id:"Lemma",label:"Lemma"},{id:"Corollary",label:"Corollary"},{id:"Conjecture",label:"Conjecture"},{id:"Proof",label:"Proof"},{id:"HistoricalNote",label:"Historical Note"},{id:"PhilosophicalJustification",label:"Philosophical Justification"},{id:"Diagram",label:"Diagram"},{id:"Example",label:"Example"}],e.createUmi=function(){var t=e.createUmiForm,o={author:e.omUser.email,message:"Initialise UMI",content:t.latexContent,title:t.title,titleSynonyms:t.titleSynonyms?t.titleSynonyms:[],prerequisiteDefinitionIds:t.prerequisiteDefinitions?t.prerequisiteDefinitions:[],seeAlsoIds:t.seeAlso?t.seeAlso:[],tags:t.tags?t.tags:[],umiType:t.type.id};console.log(o);var s=new XMLHttpRequest,i="http://127.0.0.1:8080/add",r=JSON.stringify(o);s.open("POST",i,!0),s.setRequestHeader("Content-type","application/json;charset=UTF-8"),s.onload=function(){console.log(s)},s.onerror=function(){alert("Woops, there was an error making the request."),console.log(s)},s.send(r)}}]),app.controller("DiveController",["$scope","$rootScope","$http","$location",function(e,t,o,s){if(t.title="Dive Into",t.navTopTransparentClass=!0,e.navDive=!0,e.searchUmiResultsCurrentSelection=0,e.searchResults1={currentSelection:0,data:[{title:"Title1"},{title:"Title2"}]},e.searchResults2={currentSelection:0,data:[{title:"Title3"},{title:"Title4"},{title:"Title5"}]},e.searchResultsNavigate=function(e,t){if(!e)return!1;console.log(e);var o=Object.keys(e.data).length,s=e.currentSelection;38==t.keyCode&&s>0?e.currentSelection=s-1:40==t.keyCode&&o-1>s&&(e.currentSelection=s+1)},sessionStorage.getItem("umiLastSearchTitle")){var r=sessionStorage.getItem("umiLastSearchTitle");if(e.searchUmiTerm=r,sessionStorage.getItem("umiLastSearchResults")){var n=sessionStorage.getItem("umiLastSearchResults");e.searchUmiResults=JSON.parse(n)}}e.searchUmiKeyDown=function(){var t=e.searchUmiTerm.length,s=2.5*t+"%";40>t&&(document.getElementById("masthead").style.backgroundPositionY=s),t>0?o.get(appConfig.apiUrl+"/search/"+e.searchUmiTerm).success(function(t){var o=100/(t.length+1),s=1;for(i=t.length;--i>=0;){var r=Math.floor(o*s)+"%";t[i].score=r,s+=1}e.searchUmiResults=t}).error(function(e,t){alert("No data to display :-("),console.log(e+" | "+t)}):e.searchUmiResults=!1},e.getUmi=function(t){if(!t){if(!e.searchUmiResults)return!1;t=e.searchUmiResults[e.searchUmiResultsCurrentSelection].id}sessionStorage.setItem("umiLastSearchTitle",e.searchUmiTerm),sessionStorage.setItem("umiLastSearchResults",JSON.stringify(e.searchUmiResults)),s.path("/board/"+t)},e.searchUmiResultsNavigate=function(t){if(!e.searchUmiResults)return!1;var o=Object.keys(e.searchUmiResults).length;38==t.keyCode&&e.searchUmiResultsCurrentSelection>0?e.searchUmiResultsCurrentSelection=e.searchUmiResultsCurrentSelection-1:40==t.keyCode&&e.searchUmiResultsCurrentSelection<o-1&&(e.searchUmiResultsCurrentSelection=e.searchUmiResultsCurrentSelection+1)}}]),app.controller("FeaturesController",["$scope","$rootScope",function(e,t){t.title="Features",t.navTopTransparentClass=!0,e.navFeatures=!0}]),app.controller("GlobalController",["$scope","$location","$window","$http",function(e,t,o,s){function i(){var s=t.url().split("/");e.path=""==s[1]?"dive-into":s[1],o.ga("send","pageview",{page:t.path()})}if(console.log("OpenMaths is now running"),e.$watch(function(){return t.path()},i),e.themeClass=localStorage.getItem("themeClass")?localStorage.getItem("themeClass"):"light",e.setTheme=function(t){e.themeClass=t,localStorage.setItem("themeClass",t)},e.umiFontClass=localStorage.getItem("umiFontClass")?localStorage.getItem("umiFontClass"):"umi-font-modern",e.setUmiFont=function(t){e.umiFontClass=t,localStorage.setItem("umiFontClass",t)},sessionStorage.getItem("omUser")){var r=sessionStorage.getItem("omUser");e.omUser=JSON.parse(r)}e.googleSignOut=function(){gapi.auth.signOut(),e.omUser=!1,sessionStorage.removeItem("omUser"),t.path("/")},e.googleSignIn=function(){return e.omUser?!1:void gapi.auth.signIn({callback:function(t){if(t.status.signed_in){var o=gapi.auth.getToken();s.get("https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token="+o.access_token).success(function(t){e.omUser=t,sessionStorage.setItem("omUser",JSON.stringify(t))}).error(function(e,t){alert("No data to display :-("),console.log(e+" | "+t)})}else alert(t.error),console.log("Sign-in state: "+t.error)}})},e.accessUrlUser=function(o){return e.omUser?void t.url("/"+o):(alert("You must be logged in to Contribute to OpenMaths!"),!1)}}]),app.controller("OoopsController",["$scope","$rootScope",function(e,t){t.title="Ooops"}]),app.controller("SassController",["$scope","$rootScope","$location",function(e,t){t.title="SASS Library"}]);